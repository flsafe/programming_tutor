<%= stylesheet_link_tag 'codemirror' %>
<%= stylesheet_link_tag 'mode/clike/clike' %>
<%= javascript_include_tag 'codemirror' %>
<%= javascript_include_tag 'mode/clike/clike' %>

<%= form_for @code, :url=>do_action_path, :remote=>true, :html=>{:id=>"text_editor_form"} do |f|%>
  <%= f.text_area :src_code, :id=>'text_editor' do %>
  <% end %>
  <%= f.submit "Check Syntax", :disable_with=>"Check Syntax"%>
  <%= f.submit "Check Solution", :disable_with=>"Checking Solution" %>
  <%= f.submit "Submit Solution", :disable_with=>"Submit Solution" %>
  <%= f.submit "Quit", :disable_with=>"Quit" %>
<% end %>

<script type="text/javascript">
  /* Initialize the CodeMirror text editor */
  var textEditor = CodeMirror.fromTextArea(document.getElementById('text_editor'),
      {mode: "clike",
       lineNumbers: true,
       matchBrackets: true,
       indentUnit: 2,
       tabMode: "indent"});

  /* Hide/show the spinner gif */
  $('#text_editor_form').bind('ajax:beforeSend', function(evt, xhr, settings){
    $('#message').html("");
    $('#spinner').show();
  })
  .bind('ajax:complete', function(){
    $('#spinner').hide();
  });
</script>
